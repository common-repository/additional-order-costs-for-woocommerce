window.CMB2=window.CMB2||{},function(e,t,i,a,r){"use strict";var n,o=e.cmb2_l10,c=e.setTimeout,d=function(e){return i(t.getElementById(e))};a.$id=d;var s={idNumber:!1,repeatEls:'input:not([type="button"],[id^=filelist]),select,textarea,.cmb2-media-status',noEmpty:'input:not([type="button"]):not([type="radio"]):not([type="checkbox"]),textarea',repeatUpdate:'input:not([type="button"]),select,textarea,label',styleBreakPoint:450,mediaHandlers:{},defaults:{time_picker:o.defaults.time_picker,date_picker:o.defaults.date_picker,color_picker:o.defaults.color_picker||{},code_editor:o.defaults.code_editor},media:{frames:{}}};a.init=function(){n=i(t),i.extend(a,s),a.trigger("cmb_pre_init");var r=a.metabox(),l=r.find(".cmb-repeatable-group");a.initPickers(r.find('input[type="text"].cmb2-timepicker'),r.find('input[type="text"].cmb2-datepicker'),r.find('input[type="text"].cmb2-colorpicker')),a.initCodeEditors(r.find(".cmb2-textarea-code:not(.disable-codemirror)")),i('<p><span class="button-secondary cmb-multicheck-toggle">'+o.strings.check_toggle+"</span></p>").insertBefore(".cmb2-checkbox-list:not(.no-select-all)"),a.makeListSortable(),a.makeRepeatableSortable(),r.on("change",".cmb2_upload_file",(function(){a.media.field=i(this).attr("id"),d(a.media.field+"_id").val("")})).on("click",".cmb-multicheck-toggle",a.toggleCheckBoxes).on("click",".cmb2-upload-button",a.handleMedia).on("click",".cmb-attach-list li, .cmb2-media-status .img-status img, .cmb2-media-status .file-status > span",a.handleFileClick).on("click",".cmb2-remove-file-button",a.handleRemoveMedia).on("click",".cmb-add-group-row",a.addGroupRow).on("click",".cmb-add-row-button",a.addAjaxRow).on("click",".cmb-remove-group-row",a.removeGroupRow).on("click",".cmb-remove-row-button",a.removeAjaxRow).on("keyup paste focusout",".cmb2-oembed",a.maybeOembed).on("cmb2_remove_row",".cmb-repeatable-group",a.resetTitlesAndIterator).on("click",".cmbhandle, .cmbhandle + .cmbhandle-title",a.toggleHandle),l.length&&l.on("cmb2_add_row",a.emptyValue).on("cmb2_add_row",a.setDefaults).filter(".sortable").each((function(){i(this).find(".cmb-remove-group-row-button").before('<a class="button-secondary cmb-shift-rows move-up alignleft" href="#"><span class="'+o.up_arrow_class+'"></span></a> <a class="button-secondary cmb-shift-rows move-down alignleft" href="#"><span class="'+o.down_arrow_class+'"></span></a>')})).on("click",".cmb-shift-rows",a.shiftRows),c(a.resizeoEmbeds,500),i(e).on("resize",a.resizeoEmbeds),d("addtag").length&&a.listenTagAdd(),i(t).on("cmb_init",a.mceEnsureSave),a.trigger("cmb_init")},a.mceEnsureSave=function(){wp.data&&wp.data.hasOwnProperty("subscribe")&&a.canTinyMCE()&&wp.data.subscribe((function(){var t=wp.data.hasOwnProperty("select")?wp.data.select("core/editor"):null;if(t&&t.isSavingPost&&t.isSavingPost()&&e.tinyMCE.editors.length)for(var i=0;i<e.tinyMCE.editors.length;i++)e.tinyMCE.activeEditor!==e.tinyMCE.editors[i]&&e.tinyMCE.editors[i].save()}))},a.canTinyMCE=function(){return o.user_can_richedit&&e.tinyMCE},a.listenTagAdd=function(){n.ajaxSuccess((function(e,t,i){i.data&&i.data.length&&-1!==i.data.indexOf("action=add-tag")&&a.resetBoxes(d("addtag").find(".cmb2-wrap > .cmb2-metabox"))}))},a.resetBoxes=function(e){i.each(e,(function(){a.resetBox(i(this))}))},a.resetBox=function(e){e.find(".wp-picker-clear").trigger("click"),e.find(".cmb2-remove-file-button").trigger("click"),e.find(".cmb-row.cmb-repeatable-grouping:not(:first-of-type) .cmb-remove-group-row").click(),e.find(".cmb-repeat-row:not(:first-child)").remove(),e.find('input:not([type="button"]),select,textarea').each((function(){var e=i(this),t=e.prop("tagName");if("INPUT"===t){var a=e.attr("type");"checkbox"===a||"radio"===a?e.prop("checked",!1):e.val("")}"SELECT"===t&&i("option:selected",this).prop("selected",!1),"TEXTAREA"===t&&e.html("")}))},a.resetTitlesAndIterator=function(e){e.group&&i(".cmb-repeatable-group.repeatable").each((function(){var e=i(this),t=e.find(".cmb-add-group-row").data("grouptitle");e.find(".cmb-repeatable-grouping").each((function(e){var a=i(this),r=a.find("h3.cmb-group-title");a.data("iterator",e),r.length&&r.text(t.replace("{#}",e+1))}))}))},a.toggleHandle=function(e){e.preventDefault(),a.trigger("postbox-toggled",i(this).parent(".postbox").toggleClass("closed"))},a.toggleCheckBoxes=function(e){e.preventDefault();var t=i(this),a=t.closest(".cmb-td").find("input[type=checkbox]:not([disabled])");t.data("checked")?(a.prop("checked",!1),t.data("checked",!1)):(a.prop("checked",!0),t.data("checked",!0))},a.handleMedia=function(e){e.preventDefault();var t=i(this);a.attach_id=!t.hasClass("cmb2-upload-list")&&t.closest(".cmb-td").find(".cmb2-upload-file-id").val(),a.attach_id="0"!==a.attach_id&&a.attach_id,a._handleMedia(t.prev("input.cmb2-upload-file").attr("id"),t.hasClass("cmb2-upload-list"))},a.handleFileClick=function(e){if(!i(e.target).is("a")){e.preventDefault();var t=i(this),r=t.closest(".cmb-td"),n=r.find(".cmb2-upload-button").hasClass("cmb2-upload-list");a.attach_id=n?t.find('input[type="hidden"]').data("id"):r.find(".cmb2-upload-file-id").val(),a.attach_id&&a._handleMedia(r.find("input.cmb2-upload-file").attr("id"),n,a.attach_id)}},a._handleMedia=function(e,t){if(wp){var r,n;if(n=a.mediaHandlers,(r=a.media).field=e,r.$field=d(r.field),r.fieldData=r.$field.data(),r.previewSize=r.fieldData.previewsize,r.sizeName=r.fieldData.sizename,r.fieldName=r.$field.attr("name"),r.isList=t,e in r.frames)return r.frames[e].open();r.frames[e]=wp.media({title:a.metabox().find('label[for="'+e+'"]').text(),library:r.fieldData.queryargs||{},button:{text:o.strings[t?"upload_files":"upload_file"]},multiple:!!t&&"add"}),r.frames[e].states.first().set("filterable","all"),a.trigger("cmb_media_modal_init",r),n.list=function(e,t){var i,a=[];if(n.list.templates||(n.list.templates={image:wp.template("cmb2-list-image"),file:wp.template("cmb2-list-file")}),e.each((function(e){i=n.getAttachmentHtml(e,"list"),a.push(i)})),t)return a;r.$field.siblings(".cmb2-media-status").append(a)},n.single=function(e){n.single.templates||(n.single.templates={image:wp.template("cmb2-single-image"),file:wp.template("cmb2-single-file")});var t=e.first();r.$field.val(t.get("url")),d(r.field+"_id").val(t.get("id"));var i=n.getAttachmentHtml(t,"single");r.$field.siblings(".cmb2-media-status").slideDown().html(i)},n.getAttachmentHtml=function(e,t){var i="image"===e.get("type"),a=n.prepareData(e,i);return n[t].templates[i?"image":"file"](a)},n.prepareData=function(e,t){return t&&n.getImageData.call(e,50),(e=e.toJSON()).mediaField=r.field,e.mediaFieldName=r.fieldName,e.stringRemoveImage=o.strings.remove_image,e.stringFile=o.strings.file,e.stringDownload=o.strings.download,e.stringRemoveFile=o.strings.remove_file,e},n.getImageData=function(e){var t=r.previewSize[0]||e,i=r.previewSize[1]||e,a=this.get("url"),n=this.get("width"),o=this.get("height"),c=this.get("sizes");return c&&(c[r.sizeName]?(a=c[r.sizeName].url,n=c[r.sizeName].width,o=c[r.sizeName].height):c.large&&(a=c.large.url,n=c.large.width,o=c.large.height)),n>t&&(o=Math.floor(t*o/n),n=t),o>i&&(n=Math.floor(i*n/o),o=i),n||(n=t),o||(o="svg"===this.get("filename").split(".").pop()?"100%":i),this.set("sizeUrl",a),this.set("sizeWidth",n),this.set("sizeHeight",o),this},n.selectFile=function(){var o=r.frames[e].state().get("selection"),c=t?"list":"single";a.attach_id&&t?i('[data-id="'+a.attach_id+'"]').parents("li").replaceWith(n.list(o,!0)):n[c](o),a.trigger("cmb_media_modal_select",o,r)},n.openModal=function(){var t,i=r.frames[e].state().get("selection");a.attach_id?((t=wp.media.attachment(a.attach_id)).fetch(),i.set(t?[t]:[])):i.reset(),a.trigger("cmb_media_modal_open",i,r)},r.frames[e].on("select",n.selectFile).on("open",n.openModal),r.frames[e].open()}},a.handleRemoveMedia=function(e){e.preventDefault();var r=i(this);return r.is(".cmb-attach-list .cmb2-remove-file-button")?(r.parents(".cmb2-media-item").remove(),!1):(a.media.field=r.attr("rel"),a.metabox().find(t.getElementById(a.media.field)).val(""),a.metabox().find(t.getElementById(a.media.field+"_id")).val(""),r.parents(".cmb2-media-status").html(""),!1)},a.cleanRow=function(e,t,r){var n=e.find(a.repeatUpdate);if(r){var o=e.find("[id]").not(a.repeatUpdate);e.find(".cmb-repeat-table .cmb-repeat-row:not(:first-child)").remove(),o.length&&o.each((function(){var r=i(this),n=r.attr("id"),o=n.replace("_"+t,"_"+a.idNumber),c=e.find('[data-selector="'+n+'"]');r.attr("id",o),c.length&&c.attr("data-selector",o).data("selector",o)}))}return n.filter(":checked").removeAttr("checked"),n.find(":checked").removeAttr("checked"),n.filter(":selected").removeAttr("selected"),n.find(":selected").removeAttr("selected",!1),e.find("h3.cmb-group-title").length&&e.find("h3.cmb-group-title").text(e.data("title").replace("{#}",a.idNumber+1)),n.each((function(){a.elReplacements(i(this),t,r)})),a},a.elReplacements=function(e,t,i){var r,n,o=e.attr("for"),c=e.val(),d=e.prop("type"),s=a.getFieldArg(e,"default"),l=void 0!==s&&!1!==s?s:"",p=e.prop("tagName"),u=("radio"===d||"checkbox"===d)&&c,m={};if(o)m={for:o.replace("_"+t,"_"+a.idNumber)};else{var f,h=e.attr("name");n=e.attr("id"),i?(f=h?h.replace("["+t+"][","["+a.idNumber+"]["):"",r=n?n.replace("_"+t+"_","_"+a.idNumber+"_"):""):(f=h?a.replaceLast(h,"["+t+"]","["+a.idNumber+"]"):"",r=n?a.replaceLast(n,"_"+t,"_"+a.idNumber):""),m={id:r,name:f}}if("TEXTAREA"===p&&e.html(l),"SELECT"===p&&void 0!==s){var g=e.find('[value="'+s+'"]');g.length&&g.attr("selected","selected").prop("selected","selected")}return u&&(e.removeAttr("checked"),void 0!==s&&c===s&&e.attr("checked","checked").prop("checked","checked")),!i&&e[0].hasAttribute("data-iterator")&&(m["data-iterator"]=a.idNumber),e.removeClass("hasDatepicker").val(u||l).attr(m),e},a.newRowHousekeeping=function(e){var t=e.find(".wp-picker-container"),r=e.find(".cmb2-media-status");return t.length&&t.each((function(){var e=i(this).parent();e.html(e.find('input[type="text"].cmb2-colorpicker').attr("style",""))})),r.length&&r.empty(),a},a.afterRowInsert=function(e){a.initPickers(e.find('input[type="text"].cmb2-timepicker'),e.find('input[type="text"].cmb2-datepicker'),e.find('input[type="text"].cmb2-colorpicker'))},a.updateNameAttr=function(){var e=i(this),t=e.attr("name");if(void 0!==t){var a=parseInt(e.parents(".cmb-repeatable-grouping").data("iterator"),10),r=a-1,n=t.replace("["+a+"]","["+r+"]");e.attr("name",n)}},a.emptyValue=function(e,t){i(a.noEmpty,t).val("")},a.setDefaults=function(e,t){i(a.noEmpty,t).each((function(){var e=i(this),t=a.getFieldArg(e,"default");void 0!==t&&!1!==t&&e.val(t)}))},a.addGroupRow=function(e){e.preventDefault();var t=i(this);a.triggerElement(t,"cmb2_add_group_row_start",t);var r=d(t.data("selector")),n=r.find(".cmb-repeatable-grouping").last(),o=parseInt(n.data("iterator"),10);a.idNumber=parseInt(o,10)+1;for(var c=n.clone(),s=c.prop("nodeName")||"div";r.find('.cmb-repeatable-grouping[data-iterator="'+a.idNumber+'"]').length>0;)a.idNumber++;a.newRowHousekeeping(c.data("title",t.data("grouptitle"))).cleanRow(c,o,!0),c.find(".cmb-add-row-button").prop("disabled",!1);var l,p=i("<"+s+' id="'+((l=(l=n.attr("id")).split("-")).splice(l.length-1,1),l.push(a.idNumber),l.join("-")+'" class="postbox cmb-row cmb-repeatable-grouping" data-iterator="')+a.idNumber+'">'+c.html()+"</"+s+">");n.after(p),a.afterRowInsert(p),a.triggerElement(r,{type:"cmb2_add_row",group:!0},p)},a.addAjaxRow=function(e){e.preventDefault();var t=i(this),r=d(t.data("selector")),n=r.find(".empty-row"),o=parseInt(n.find("[data-iterator]").data("iterator"),10);a.idNumber=parseInt(o,10)+1;var c=n.clone();a.newRowHousekeeping(c).cleanRow(c,o),n.removeClass("empty-row hidden").addClass("cmb-repeat-row"),n.after(c),a.afterRowInsert(c),a.triggerElement(r,{type:"cmb2_add_row",group:!1},c,n)},a.removeGroupRow=function(t){t.preventDefault();var r=i(this),n=r.data("confirm");if(!n||e.confirm(n)){var o=d(r.data("selector")),c=r.parents(".cmb-repeatable-grouping");if(o.find(".cmb-repeatable-grouping").length<2)return a.resetRow(c.parents(".cmb-repeatable-group").find(".cmb-add-group-row"),r);a.triggerElement(o,"cmb2_remove_group_row_start",r),c.nextAll(".cmb-repeatable-grouping").find(a.repeatEls).each(a.updateNameAttr),c.remove(),a.triggerElement(o,{type:"cmb2_remove_row",group:!0})}},a.removeAjaxRow=function(e){e.preventDefault();var t=i(this);if(!t.hasClass("button-disabled")){var r=t.parents(".cmb-row"),n=t.parents(".cmb-repeat-table");if(n.find(".cmb-row").length<=2)return a.resetRow(r.find(".cmb-add-row-button"),t);r.hasClass("empty-row")&&r.prev().addClass("empty-row").removeClass("cmb-repeat-row"),t.parents(".cmb-repeat-table .cmb-row").remove(),a.triggerElement(n,{type:"cmb2_remove_row",group:!1})}},a.resetRow=function(e,t){e.trigger("click"),t.trigger("click")},a.shiftRows=function(e){e.preventDefault();var t=i(this),r=t.parents(".cmb-repeatable-grouping"),n=t.hasClass("move-up")?r.prev(".cmb-repeatable-grouping"):r.next(".cmb-repeatable-grouping");if(a.triggerElement(t,"cmb2_shift_rows_enter",t,r,n),n.length){a.triggerElement(t,"cmb2_shift_rows_start",t,r,n);var o=[];r.find(a.repeatEls).each((function(){var e,t=i(this),a=t.attr("type");e=t.hasClass("cmb2-media-status")?t.html():"checkbox"===a||"radio"===a?t.is(":checked"):"select"===t.prop("tagName")?t.is(":selected"):t.val(),o.push({val:e,$:t})})),n.find(a.repeatEls).each((function(e){var t,a=i(this),r=a.attr("type");if(a.hasClass("cmb2-media-status")){var n=a.closest(".cmb-repeatable-grouping").attr("data-iterator"),c=o[e].$.closest(".cmb-repeatable-grouping").attr("data-iterator");t=a.html(),a.html(o[e].val),o[e].$.html(t),o[e].$.find("input").each((function(){var e=i(this).attr("name");e=e.replace("["+n+"]","["+c+"]"),i(this).attr("name",e)})),a.find("input").each((function(){var e=i(this).attr("name");e=e.replace("["+c+"]","["+n+"]"),i(this).attr("name",e)}))}else"checkbox"===r?(o[e].$.prop("checked",a.is(":checked")),a.prop("checked",o[e].val)):"radio"===r?(a.is(":checked")&&o[e].$.attr("data-checked","true"),o[e].$.is(":checked")&&a.attr("data-checked","true")):"select"===a.prop("tagName")?(o[e].$.prop("selected",a.is(":selected")),a.prop("selected",o[e].val)):(o[e].$.val(a.val()),a.val(o[e].val))})),r.find("input[data-checked=true]").prop("checked",!0).removeAttr("data-checked"),n.find("input[data-checked=true]").prop("checked",!0).removeAttr("data-checked"),r.find('input[type="text"].cmb2-colorpicker').trigger("change"),n.find('input[type="text"].cmb2-colorpicker').trigger("change"),a.triggerElement(t,"cmb2_shift_rows_complete",t,r,n)}},a.initPickers=function(e,t,i){a.trigger("cmb_init_pickers",{time:e,date:t,color:i}),a.initDateTimePickers(e,"timepicker","time_picker"),a.initDateTimePickers(t,"datepicker","date_picker"),a.initColorPickers(i)},a.initDateTimePickers=function(e,t,r){e.length&&e[t]("destroy").each((function(){var e=i(this),n=e.data(t)||{},o=i.extend({},a.defaults[r],n);e[t](a.datePickerSetupOpts(n,o,t))}))},a.datePickerSetupOpts=function(e,t,r){var n=i.extend({},t);return t.beforeShow=function(e,t){"timepicker"===r&&a.addTimePickerClasses(t.dpDiv),d("ui-datepicker-div").addClass("cmb2-element"),"function"==typeof n.beforeShow&&n.beforeShow(e,t)},"timepicker"===r&&(t.onChangeMonthYear=function(e,t,i,r){a.addTimePickerClasses(i.dpDiv),"function"==typeof n.onChangeMonthYear&&n.onChangeMonthYear(e,t,i,r)}),t.onClose=function(e,t){var a=d("ui-datepicker-div").removeClass("cmb2-element").hide();"timepicker"!==r||i(t.input).val()||t.input.val(a.find(".ui_tpicker_time").text()),"function"==typeof n.onClose&&n.onClose(e,t)},t},a.addTimePickerClasses=function(e){var t=a.addTimePickerClasses;t.count=t.count||0,c((function(){e.find(".ui-priority-secondary").length?(e.find(".ui-priority-secondary").addClass("button-secondary"),e.find(".ui-priority-primary").addClass("button-primary"),t.count=0):t.count<5&&(t.count++,t(e))}),10)},a.initColorPickers=function(e){e.length&&("object"==typeof jQuery.wp&&"function"==typeof jQuery.wp.wpColorPicker?e.each((function(){var e=i(this),t=e.data("colorpicker")||{};e.wpColorPicker(i.extend({},a.defaults.color_picker,t))})):e.each((function(e){i(this).after('<div id="picker-'+e+'" style="z-index: 1000; background: #EEE; border: 1px solid #CCC; position: absolute; display: block;"></div>'),d("picker-"+e).hide().farbtastic(i(this))})).focus((function(){i(this).next().show()})).blur((function(){i(this).next().hide()})))},a.initCodeEditors=function(e){a.trigger("cmb_init_code_editors",e),a.defaults.code_editor&&wp&&wp.codeEditor&&e.length&&e.each((function(){wp.codeEditor.initialize(this.id,a.codeEditorArgs(i(this).data("codeeditor")))}))},a.codeEditorArgs=function(e){var t=["codemirror","csslint","jshint","htmlhint"],r=i.extend({},a.defaults.code_editor);e=e||{};for(var n=t.length-1;n>=0;n--)e.hasOwnProperty(t[n])&&(r[t[n]]=i.extend({},r[t[n]]||{},e[t[n]]));return r},a.makeListSortable=function(){var e=a.metabox().find(".cmb2-media-status.cmb-attach-list");e.length&&e.sortable({cursor:"move"}).disableSelection()},a.makeRepeatableSortable=function(){var e=a.metabox().find(".cmb-repeat-table .cmb-field-list");e.length&&e.sortable({items:".cmb-repeat-row",cursor:"move",cancel:"input,textarea,button,select,option,.CodeMirror"})},a.maybeOembed=function(e){var t=i(this);({focusout:function(){c((function(){a.spinner(".cmb2-metabox",!0)}),2e3)},keyup:function(){var i=function(t,i){return e.which<=i&&e.which>=t};(i(48,90)||i(96,111)||i(8,9)||187===e.which||190===e.which)&&a.doAjax(t,e)},paste:function(){c((function(){a.doAjax(t)}),100)}})[e.type]()},a.resizeoEmbeds=function(){a.metabox().each((function(){var e=i(this),t=e.parents(".inside"),r=e.parents(".inner-sidebar").length||e.parents("#side-sortables").length,n=r,o=!1;if(!t.length)return!0;var c=t.width();a.styleBreakPoint>c&&(n=!0,o=a.styleBreakPoint-62>c);var d=(c=n?c:Math.round(.82*t.width()*.97))-30;if(!n||r||o||(d-=75),d>639)return!0;var s=e.find(".cmb-type-oembed .embed-status").children().not(".cmb2-remove-wrapper");if(!s.length)return!0;s.each((function(){var e=i(this),t=e.width(),a=e.height(),r=d;e.parents(".cmb-repeat-row").length&&!n&&(r=d-91,r=785>c?r-15:r);var o=Math.round(r*a/t);e.width(r).height(o)}))}))},a.doAjax=function(e){var t=e.val();if(!(t.length<6)){var r=e.attr("id"),n=e.closest(".cmb-td"),d=n.find(".embed-status"),s=n.find(".embed_wrap"),l=d.find(":first-child"),p=d.length&&l.length?l.width():e.width();a.log("oembed_url",t,r),a.spinner(n),s.html(""),c((function(){i(".cmb2-oembed:focus").val()===t&&i.ajax({type:"post",dataType:"json",url:o.ajaxurl,data:{action:"cmb2_oembed_handler",oembed_url:t,oembed_width:p>300?p:300,field_id:r,object_id:e.data("objectid"),object_type:e.data("objecttype"),cmb2_ajax_nonce:o.ajax_nonce},success:function(e){a.log(e),a.spinner(n,!0),s.html(e.data)}})}),500)}},a.metabox=function(){return a.$metabox||(a.$metabox=i(".cmb2-wrap > .cmb2-metabox")),a.$metabox},a.spinner=function(e,t){var a=t?"removeClass":"addClass";i(".cmb-spinner",e)[a]("is-active")},a.trigger=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(a),n.trigger(e,t)},a.triggerElement=function(e,t){var i=Array.prototype.slice.call(arguments,2);i.push(a),e.trigger(t,i)},a.getFieldArg=function(e,t){return a.getField(e)[t]},a.getFields=function(e){if("function"==typeof e){var t=[];return i.each(o.fields,(function(i,a){e(a,i)&&t.push(a)})),t}return o.fields},a.getField=function(e){var t={};if(e=e instanceof jQuery?e.data("hash"):e)try{if(o.fields[e])throw new Error(e);a.getFields((function(t){if("function"==typeof e){if(e(t))throw new Error(t.hash)}else if(t.id&&t.id===e)throw new Error(t.hash)}))}catch(e){t=o.fields[e.message]}return t},a.log=function(){o.script_debug&&console&&"function"==typeof console.log&&console.log.apply(console,arguments)},a.replaceLast=function(e,t,i){var a=e.lastIndexOf(t);return e.slice(0,a)+e.slice(a).replace(t,i)},i(a.init)}(window,document,jQuery,window.CMB2),window.CMB2=window.CMB2||{},window.CMB2.wysiwyg=window.CMB2.wysiwyg||{},function(e,t,i,a,r,n){"use strict";function o(){0===d.length?s.forEach((function(e){s.splice(s.indexOf(e),1),r.init.apply(r,e)})):e.setTimeout(o,100)}function c(){d.forEach((function(e){d.splice(d.indexOf(e),1),r.destroy(e)}))}var d=[],s=[],l=r.all={};r.initAll=function(){var a,n,o;i(".cmb2-wysiwyg-placeholder").each((function(){a=i(this),(n=a.data()).groupid&&(n.id=a.attr("id"),n.name=a.attr("name"),n.value=a.val(),r.init(a,n,!1),o=!0)})),!0===o&&(void 0!==e.QTags&&e.QTags._buttonsInit(),i(t).on("cmb2_add_row",r.addRow).on("cmb2_remove_group_row_start",r.destroyRowEditors).on("cmb2_shift_rows_start",r.shiftStart).on("cmb2_shift_rows_complete",r.shiftComplete))},r.addRow=function(e,t){r.initRow(t,e)},r.destroyRowEditors=function(e,t){r.destroy(t.parents(".cmb-repeatable-grouping").find(".wp-editor-area").attr("id"))},r.shiftStart=function(e,t,a,n){a.add(n).find(".wp-editor-wrap textarea").each((function(){r.destroy(i(this).attr("id"))}))},r.shiftComplete=function(e,t,a,n){a.add(n).each((function(){r.initRow(i(this),e)}))},r.initRow=function(t,n){var c,l,p;t.find(".cmb2-wysiwyg-inner-wrap").each((function(){c=i(this),l=c.data(),p=void 0!==(p=a.getFieldArg(l.hash,"default",""))&&!1!==p?p:"",l.iterator=t.data("iterator"),l.fieldid=l.id,l.id=l.groupid+"_"+l.iterator+"_"+l.fieldid,l.name=l.groupid+"["+l.iterator+"]["+l.fieldid+"]",l.value="cmb2_add_row"!==n.type&&c.find(".wp-editor-area").length?c.find(".wp-editor-area").val():p,0===d.length?r.init(c,l):(s.push([c,l]),e.setTimeout(o,100))}))},r.init=function(r,n,o){if(!n.groupid)return!1;var c=a.canTinyMCE(),d="function"==typeof e.quicktags;i.extend(n,function(e){var t=e.groupid,a=e.fieldid;return l[t]&&l[t][a]||(l[t]=l[t]||{},l[t][a]={template:wp.template("cmb2-wysiwyg-"+t+"-"+a),defaults:{mce:i.extend({},tinyMCEPreInit.mceInit["cmb2_i_"+t+a]),qt:i.extend({},tinyMCEPreInit.qtInit["cmb2_i_"+t+a])}},delete tinyMCEPreInit.mceInit["cmb2_i_"+t+a],delete tinyMCEPreInit.qtInit["cmb2_i_"+t+a]),l[t][a]}(n)),function(e){var t,a,r,n=new RegExp("cmb2_n_"+e.groupid+e.fieldid,"g"),o=new RegExp("cmb2_i_"+e.groupid+e.fieldid,"g");if(void 0===tinyMCEPreInit.mceInit[e.id]){for(t in a=i.extend({},e.defaults.mce))"string"==typeof a[t]&&(a[t]=a[t].replace(o,e.id).replace(n,e.name));tinyMCEPreInit.mceInit[e.id]=a}if(void 0===tinyMCEPreInit.qtInit[e.id]){for(t in r=i.extend({},e.defaults.qt))"string"==typeof r[t]&&(r[t]=r[t].replace(o,e.id).replace(n,e.name));tinyMCEPreInit.qtInit[e.id]=r}}(n),r.replaceWith(n.template(n)),c&&e.tinyMCE.init(tinyMCEPreInit.mceInit[n.id]),d&&e.quicktags(tinyMCEPreInit.qtInit[n.id]),c&&i(t.getElementById(n.id)).parents(".wp-editor-wrap").removeClass("html-active").addClass("tmce-active"),!1!==o&&void 0!==e.QTags&&e.QTags._buttonsInit()},r.destroy=function(t){if(a.canTinyMCE()){var i=tinyMCE.get(t);null!=i?(i.destroy(),void 0===tinyMCEPreInit.mceInit[t]&&delete tinyMCEPreInit.mceInit[t],void 0===tinyMCEPreInit.qtInit[t]&&delete tinyMCEPreInit.qtInit[t]):-1===d.indexOf(t)&&(d.push(t),e.setTimeout(c,100))}},i(t).on("cmb_init",r.initAll)}(window,document,jQuery,window.CMB2,window.CMB2.wysiwyg),window.CMB2=window.CMB2||{},window.CMB2.charcounter=window.CMB2.charcounter||{},function(e,t,i,a,r){"use strict";if(!wp.utils||!wp.utils.WordCounter)return a.log("Cannot find wp.utils!");r.counters={};var n=r.counters,o=new wp.utils.WordCounter;r.updateCounter=function(e){if(!n.hasOwnProperty(e))return null;var t=n[e],i=t.editor&&!t.editor.isHidden()?t.editor.getContent({format:"raw"}):a.$id(e).val().trim(),r=o.count(i,t.type),c=t.max&&r>t.max,d=t.max?t.max-r:r;return t.$el.parents(".cmb2-char-counter-wrap")[c?"addClass":"removeClass"]("cmb2-max-exceeded"),t.$el.val(d).outerWidth(8*String(d).length+15+"px"),r},r.instantiate=function(e){var t=e.data();if(!(t.fieldId in n)){var i={$el:e,max:t.max,type:"words"===t.counterType?"words":"characters_including_spaces",editor:!1};n[t.fieldId]=i,r.updateCounter(t.fieldId)}},r.initAll=function(){i(".cmb2-char-counter").each((function(){r.instantiate(i(this))}))},r.initWysiwyg=function(e,t){t.id in n&&(n[t.id].editor=t,t.on("nodechange keyup",r.countWysiwyg))},r.addRow=function(e,t){t.find(".cmb2-char-counter").each((function(){var e=i(this),t=e.attr("id").replace(/^char-counter-/,"");e.attr("data-field-id",t).data("field-id",t),r.instantiate(e)}))},r.cleanCounters=function(){var e,i=[];for(e in n)t.getElementById(e)||i.push(e);i.length&&_.each(i,(function(e){delete n[e]}))},r.countWysiwyg=_.throttle((function(e){return e.hasOwnProperty("element")?r.updateCounter(i(e.element).data("id")):e.hasOwnProperty("currentTarget")?r.updateCounter(i(e.currentTarget).data("id")):void 0})),r.countTextarea=_.throttle((function(e){r.updateCounter(e.currentTarget.id)}),400),i(t).on("cmb_init",r.initAll).on("tinymce-editor-init",r.initWysiwyg).on("cmb2_add_row",r.addRow).on("cmb2_remove_row",r.cleanCounters).on("input keyup",".cmb2-count-chars",r.countTextarea)}(window,document,jQuery,window.CMB2,window.CMB2.charcounter);